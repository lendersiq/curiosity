<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Trwth</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48cG9seWdvbiBwb2ludHM9IjI1IDIwLDUwIDAsNzUgMjAsNzUgODAsNTAgMTAwLDI1IDgwIiBmaWxsPSIjMkU4QkMwIi8+PHBvbHlnb24gcG9pbnRzPSIwIDAsMjUgMjAsNTAgMTAwLDI1IDgwIiBmaWxsPSIjMEEyNTQwIi8+PHBvbHlnb24gcG9pbnRzPSIxMDAgMCw3NSAyMCw1MCAxMDAgNzUgODAiIGZpbGw9IiM1OEM2QjEiLz48L3N2Zz4=" type="image/svg+xml" />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div id="app">
    <header class="app-header">
      <div class="brand">
        <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48cG9seWdvbiBwb2ludHM9IjI1IDIwLDUwIDAsNzUgMjAsNzUgODAsNTAgMTAwLDI1IDgwIiBmaWxsPSIjMkU4QkMwIi8+PHBvbHlnb24gcG9pbnRzPSIwIDAsMjUgMjAsNTAgMTAwLDI1IDgwIiBmaWxsPSIjMEEyNTQwIi8+PHBvbHlnb24gcG9pbnRzPSIxMDAgMCw3NSAyMCw1MCAxMDAgNzUgODAiIGZpbGw9IiM1OEM2QjEiLz48L3N2Zz4=" alt="TRWTH" class="button-icon">
        <span class="brand-name">Trwth</span>
      </div>
      <div class="brand-subtitle">
        Private AI v1.12.15
      </div>
    </header>

    <main class="app-main">
      <!-- Left: File / Source Manager -->
      <section class="panel panel-left">
        <h2>Data Sources</h2>

        <div class="file-import">
          <label class="file-label">
            <span>üìÅ Select CSV / JSON / XLSX Files</span>
            <input type="file" id="file-input" multiple accept=".csv,.json,.xlsx,.xls" />
          </label>
        </div>

        <div id="file-status" class="file-status" style="display: none;"></div>

        <div id="loading-spinner" class="loading-spinner" style="display: none;">
          <div class="spinner"></div>
          <span id="spinner-text">Processing files...</span>
        </div>

        <div class="selected-files" id="selected-files" style="display: none;">
          <h4>Selected Files</h4>
          <ul id="selected-files-list"></ul>
          <div class="selected-files-actions">
            <button id="btn-import" class="btn-primary">Import Selected</button>
          </div>
        </div>

        <div class="sources-list">
          <h3>Loaded Sources</h3>
          <ul id="sources-ul"></ul>
        </div>

        <div class="schema-view">
          <h3>Schema</h3>
          <pre id="schema-pre" class="schema-pre"></pre>
        </div>
      </section>

      <!-- Right: AI Prompt + Results -->
      <section class="panel panel-right">
        <h2>Ask the Private AI</h2>

        <div class="prompt-box">
          <textarea id="prompt-input" rows="4"
            placeholder="Example: show me all loans between $400 and $18,000 closed in the last 12 months"></textarea>
          <div class="prompt-controls">
            <button id="btn-microphone" class="btn-icon btn-microphone" title="Voice input">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"/>
                <path d="M19 10v1a7 7 0 0 1-14 0v-1"/>
                <line x1="12" y1="19" x2="12" y2="23"/>
                <line x1="8" y1="23" x2="16" y2="23"/>
              </svg>
            </button>
            <button id="btn-run" class="btn-primary">Run Query</button>
          </div>
        </div>

        <div class="debug-section">
          <details open>
            <summary>Query Plan</summary>
            <pre id="plan-pre"></pre>
          </details>
        </div>

        <div class="results-section">
          <h3>Results</h3>
          <div id="results-container" class="results-container"></div>
        </div>
      </section>
    </main>
  </div>

  <!-- NO type="module" ‚Äì classic scripts for file:// -->
  <script src="js/db.js"></script>
  <!-- Load institution-provided translators first (defines window.Translators data) -->
  <script src="translator/custom_translator.js"></script>
  <!-- Loader/registry merges translators and exposes registerTranslator -->
  <script src="translator/translator_loader.js"></script>
  <script src="js/dataManager.js"></script>
  <script src="js/nlpEngine.js"></script>
  <script src="js/conceptMapper.js"></script>
  <script src="js/statistical.js"></script>
  <script src="js/library/financial.js"></script>
  <script src="js/functionRegistry.js"></script>
  <script src="js/queryEngine.js"></script>
  <script src="js/app.js"></script>
</body>
</html>
